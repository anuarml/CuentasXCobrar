<script type="text/javascript">for(var keys=document.querySelectorAll("#calculator span"),operators=["+","-","*","/","%"],decimalAdded=!1,isPercentage=!1,equation,firstbtnVal,pressedBtn=!1,documentAmount,input=document.querySelector(".screen"),docRow,i=0;i<keys.length;i++)keys[i].onclick=function(f){var d=input.innerHTML,a=this.innerHTML;if("C"==a)input.innerHTML="",isPercentage=decimalAdded=!1;else if("="==a){equation=d;var b=equation[equation.length-1];if(-1<operators.indexOf(b)||"."==b)equation=equation.replace(/.$/,"");equation&&(-1<operators.indexOf(b)?(isPercentage=!1,b=calculateResult(equation,isPercentage),input.innerHTML=eval(b)):input.innerHTML=eval(equation),$("#documentAmount").val(parseFloat(input.innerHTML)||0),$("#documentAmount").change(),$("#calculatorModal").modal("toggle"));decimalAdded=!1}else-1<operators.indexOf(a)?(b=d[d.length-1],""!=d&&-1==operators.indexOf(b)?input.innerHTML+=a:""==d&&"-"==a&&(input.innerHTML+=a),-1<operators.indexOf(b)&&1<d.length&&(input.innerHTML=d.replace(/.$/,a)),decimalAdded=!1):"."==a?decimalAdded||(input.innerHTML+=a,decimalAdded=!0):input.innerHTML+=a;-1<operators.indexOf(a)&&3>=operators.indexOf(a)&&0==pressedBtn&&(firstbtnVal=a,console.log(firstbtnVal),pressedBtn=!0);-1<operators.indexOf(a)&&3<=d.length&&(equation=d)&&(4==operators.indexOf(a)?(isPercentage=!0,b=calculateResult(equation,isPercentage),input.innerHTML=eval(b),pressedBtn=!1):(isPercentage=!1,b=calculateResult(equation,isPercentage),input.innerHTML=eval(b),input.innerHTML+=a,firstbtnVal=a),console.log(firstbtnVal),d.length=0);f.preventDefault()};function calculateResult(f,d){var a,b=firstbtnVal,c,e;console.log(f);c=f.split(b);console.log(c[0]);console.log(c[1]);a=new Decimal(c[0]);c=new Decimal(c[1]);console.log(a);console.log(c);c=d?c.dividedBy(100).times(a):c;console.log(c);switch(b){case "+":e=a.plus(c);break;case "-":e=a.minus(c);break;case "*":e=a.times(c);break;case "/":e=a.dividedBy(c)}return e};</script>
var proBalance=$("#pro_balance"),previousProBalanceAmount=0;proBalance.change(function(){var a=parseFloat(proBalance.val());if(0>a||isNaN(a))proBalance.val(previousProBalanceAmount.toFixed(2));else{var b=$("#totalCharge"),c;c=calculateTotal(b.val(),a,previousProBalanceAmount);b.val(c.toFixed(2));b.change();previousProBalanceAmount=a;proBalance.val(a.toFixed(2))}});proBalance.focus(function(){proBalance.val("")});proBalance.blur(function(){""==proBalance.val()&&proBalance.val(previousProBalanceAmount.toFixed(2))});var change=$("#change"),previousChangeAmount=0,paymentTypeListChangeAllowed=[];change.change(function(){var a=change.val();if(0>a||isNaN(a))change.val(previousChangeAmount.toFixed(2));else{var a=parseFloat(a),b=$("#totalChangeAllowed"),b=parseFloat(b.val())||0;a>b&&(change.val("0.00"),a=0,alert("El cambio excede el cambio permitido"));var b=$("#totalCharge"),c=parseFloat(b.val())||0,c=calculateTotal(c,-a,-previousChangeAmount);b.val(c.toFixed(2));b.change();previousChangeAmount=a;change.val(a.toFixed(2))}});change.focus(function(){change.val("")});change.blur(function(){""==change.val()&&change.val(previousChangeAmount.toFixed(2))});$("#totalCharge").change(function(){var a=$(this);calcTaxes(a.val());calculateChargeDifference()});function calculateChargeDifference(){var a=$("#totalAmount"),b=$("#totalCharge"),a=parseFloat(a.val())||0,b=parseFloat(b.val())||0,b=(new Decimal(a)).minus(b).toNumber();$("#difference").val(b.toFixed(2))}$("#totalAmount").change(function(){calculateChargeDifference()});$("#totalChangeAllowed").change(function(){change.change()});$(window).load(function(){nChangeAmount?change.val(nChangeAmount):change.val("0.00");change.change();proBalance.change()});